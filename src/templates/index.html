{% extends "layout.html" %}

{% block title %}
citation app
{% endblock %}

{% block body %}

<h2>citation app</h2>

<div>
  <a href="/new_citation">Create new citation</a>
</div>

{% if book_citations %}
  <h3>Added citations:</h3>
  <form action="/delete_citations" method="post" class="delete_citations">
    {% for id, type, title, author, publisher, isbn, year in book_citations %}
      <li class="citation">
        {{ author }}. <em>{{ title }}.</em> {{ publisher }}, {{ year }}. ISBN: {{ isbn }}
        <input type="checkbox" name="citation_id" value="{{ id }}" class="checkbox">
      </li>
    {% endfor %}
    <input type="submit" value="Delete selected citations" style="display:none" id="deleteButton">
  </form>

  <script>
    document.addEventListener("DOMContentLoaded", function () {
      let deleteButton = document.getElementById("deleteButton");
      let form = document.querySelector("form.delete_citations");
      let checkbox = form.querySelectorAll("input[name='citation_id']");

      function updateDeleteButton() {
        let anyChecked = Array.from(checkbox).some(checkbox => checkbox.checked);
        if (anyChecked) {
          deleteButton.style.display = "block"; }
        else {
          deleteButton.style.display = "none";
        }}

      checkbox.forEach(checkbox => checkbox.addEventListener("change", updateDeleteButton));
      updateDeleteButton();
    });
  </script>

{% endif %}

{% endblock %}